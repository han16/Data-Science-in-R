<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>lecture5</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">lecture5</h1>

</div>


<pre class="r"><code>########################################################
#### Read Chapter 12: http://r4ds.had.co.nz/transform.html
#### Read http://stat545.com/block015_graph-dos-donts.html
####
#### We will go over HW3 and talk through each problem.
####
#### Any questions from last week? 
#### {Boolean logic, start of tidyverse, pipes, package install}
######################################################</code></pre>
<div id="first-some-review-about-the-tidyverse" class="section level2">
<h2>First some review about the tidyverse:</h2>
<ul>
<li>dplyr</li>
</ul>
<pre class="r"><code>library(tidyverse)  # first load the package</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.7
## ✔ tidyr   0.8.2     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>## dplyr
## =&gt; filter, select, mutate, group_by, tally, summarize, arrange, unique, na.omit
data(iris)
iris %&gt;% select(Sepal.Length) %&gt;% unlist() %&gt;% mean()</code></pre>
<pre><code>## [1] 5.843333</code></pre>
<pre class="r"><code>mean(iris$Sepal.Length)</code></pre>
<pre><code>## [1] 5.843333</code></pre>
<pre class="r"><code>iris %&gt;% summarize(mean.SL = mean(Sepal.Length))</code></pre>
<pre><code>##    mean.SL
## 1 5.843333</code></pre>
<pre class="r"><code>## Mean Sepal.Length per species
iris %&gt;% 
  group_by(Species) %&gt;% 
  summarize(mean(Sepal.Length),
            median.SL = median(Sepal.Length))</code></pre>
<pre><code>## # A tibble: 3 x 3
##   Species    `mean(Sepal.Length)` median.SL
##   &lt;fct&gt;                     &lt;dbl&gt;     &lt;dbl&gt;
## 1 setosa                     5.01       5  
## 2 versicolor                 5.94       5.9
## 3 virginica                  6.59       6.5</code></pre>
<pre class="r"><code>iris %&gt;% arrange(Sepal.Length, Sepal.Width)</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            4.3         3.0          1.1         0.1     setosa
## 2            4.4         2.9          1.4         0.2     setosa
## 3            4.4         3.0          1.3         0.2     setosa
## 4            4.4         3.2          1.3         0.2     setosa
## 5            4.5         2.3          1.3         0.3     setosa
## 6            4.6         3.1          1.5         0.2     setosa
## 7            4.6         3.2          1.4         0.2     setosa
## 8            4.6         3.4          1.4         0.3     setosa
## 9            4.6         3.6          1.0         0.2     setosa
## 10           4.7         3.2          1.3         0.2     setosa
## 11           4.7         3.2          1.6         0.2     setosa
## 12           4.8         3.0          1.4         0.1     setosa
## 13           4.8         3.0          1.4         0.3     setosa
## 14           4.8         3.1          1.6         0.2     setosa
## 15           4.8         3.4          1.6         0.2     setosa
## 16           4.8         3.4          1.9         0.2     setosa
## 17           4.9         2.4          3.3         1.0 versicolor
## 18           4.9         2.5          4.5         1.7  virginica
## 19           4.9         3.0          1.4         0.2     setosa
## 20           4.9         3.1          1.5         0.1     setosa
## 21           4.9         3.1          1.5         0.2     setosa
## 22           4.9         3.6          1.4         0.1     setosa
## 23           5.0         2.0          3.5         1.0 versicolor
## 24           5.0         2.3          3.3         1.0 versicolor
## 25           5.0         3.0          1.6         0.2     setosa
## 26           5.0         3.2          1.2         0.2     setosa
## 27           5.0         3.3          1.4         0.2     setosa
## 28           5.0         3.4          1.5         0.2     setosa
## 29           5.0         3.4          1.6         0.4     setosa
## 30           5.0         3.5          1.3         0.3     setosa
## 31           5.0         3.5          1.6         0.6     setosa
## 32           5.0         3.6          1.4         0.2     setosa
## 33           5.1         2.5          3.0         1.1 versicolor
## 34           5.1         3.3          1.7         0.5     setosa
## 35           5.1         3.4          1.5         0.2     setosa
## 36           5.1         3.5          1.4         0.2     setosa
## 37           5.1         3.5          1.4         0.3     setosa
## 38           5.1         3.7          1.5         0.4     setosa
## 39           5.1         3.8          1.5         0.3     setosa
## 40           5.1         3.8          1.9         0.4     setosa
## 41           5.1         3.8          1.6         0.2     setosa
## 42           5.2         2.7          3.9         1.4 versicolor
## 43           5.2         3.4          1.4         0.2     setosa
## 44           5.2         3.5          1.5         0.2     setosa
## 45           5.2         4.1          1.5         0.1     setosa
## 46           5.3         3.7          1.5         0.2     setosa
## 47           5.4         3.0          4.5         1.5 versicolor
## 48           5.4         3.4          1.7         0.2     setosa
## 49           5.4         3.4          1.5         0.4     setosa
## 50           5.4         3.7          1.5         0.2     setosa
## 51           5.4         3.9          1.7         0.4     setosa
## 52           5.4         3.9          1.3         0.4     setosa
## 53           5.5         2.3          4.0         1.3 versicolor
## 54           5.5         2.4          3.8         1.1 versicolor
## 55           5.5         2.4          3.7         1.0 versicolor
## 56           5.5         2.5          4.0         1.3 versicolor
## 57           5.5         2.6          4.4         1.2 versicolor
## 58           5.5         3.5          1.3         0.2     setosa
## 59           5.5         4.2          1.4         0.2     setosa
## 60           5.6         2.5          3.9         1.1 versicolor
## 61           5.6         2.7          4.2         1.3 versicolor
## 62           5.6         2.8          4.9         2.0  virginica
## 63           5.6         2.9          3.6         1.3 versicolor
## 64           5.6         3.0          4.5         1.5 versicolor
## 65           5.6         3.0          4.1         1.3 versicolor
## 66           5.7         2.5          5.0         2.0  virginica
## 67           5.7         2.6          3.5         1.0 versicolor
## 68           5.7         2.8          4.5         1.3 versicolor
## 69           5.7         2.8          4.1         1.3 versicolor
## 70           5.7         2.9          4.2         1.3 versicolor
## 71           5.7         3.0          4.2         1.2 versicolor
## 72           5.7         3.8          1.7         0.3     setosa
## 73           5.7         4.4          1.5         0.4     setosa
## 74           5.8         2.6          4.0         1.2 versicolor
## 75           5.8         2.7          4.1         1.0 versicolor
## 76           5.8         2.7          3.9         1.2 versicolor
## 77           5.8         2.7          5.1         1.9  virginica
## 78           5.8         2.7          5.1         1.9  virginica
## 79           5.8         2.8          5.1         2.4  virginica
## 80           5.8         4.0          1.2         0.2     setosa
## 81           5.9         3.0          4.2         1.5 versicolor
## 82           5.9         3.0          5.1         1.8  virginica
## 83           5.9         3.2          4.8         1.8 versicolor
## 84           6.0         2.2          4.0         1.0 versicolor
## 85           6.0         2.2          5.0         1.5  virginica
## 86           6.0         2.7          5.1         1.6 versicolor
## 87           6.0         2.9          4.5         1.5 versicolor
## 88           6.0         3.0          4.8         1.8  virginica
## 89           6.0         3.4          4.5         1.6 versicolor
## 90           6.1         2.6          5.6         1.4  virginica
## 91           6.1         2.8          4.0         1.3 versicolor
## 92           6.1         2.8          4.7         1.2 versicolor
## 93           6.1         2.9          4.7         1.4 versicolor
## 94           6.1         3.0          4.6         1.4 versicolor
## 95           6.1         3.0          4.9         1.8  virginica
## 96           6.2         2.2          4.5         1.5 versicolor
## 97           6.2         2.8          4.8         1.8  virginica
## 98           6.2         2.9          4.3         1.3 versicolor
## 99           6.2         3.4          5.4         2.3  virginica
## 100          6.3         2.3          4.4         1.3 versicolor
## 101          6.3         2.5          4.9         1.5 versicolor
## 102          6.3         2.5          5.0         1.9  virginica
## 103          6.3         2.7          4.9         1.8  virginica
## 104          6.3         2.8          5.1         1.5  virginica
## 105          6.3         2.9          5.6         1.8  virginica
## 106          6.3         3.3          4.7         1.6 versicolor
## 107          6.3         3.3          6.0         2.5  virginica
## 108          6.3         3.4          5.6         2.4  virginica
## 109          6.4         2.7          5.3         1.9  virginica
## 110          6.4         2.8          5.6         2.1  virginica
## 111          6.4         2.8          5.6         2.2  virginica
## 112          6.4         2.9          4.3         1.3 versicolor
## 113          6.4         3.1          5.5         1.8  virginica
## 114          6.4         3.2          4.5         1.5 versicolor
## 115          6.4         3.2          5.3         2.3  virginica
## 116          6.5         2.8          4.6         1.5 versicolor
## 117          6.5         3.0          5.8         2.2  virginica
## 118          6.5         3.0          5.5         1.8  virginica
## 119          6.5         3.0          5.2         2.0  virginica
## 120          6.5         3.2          5.1         2.0  virginica
## 121          6.6         2.9          4.6         1.3 versicolor
## 122          6.6         3.0          4.4         1.4 versicolor
## 123          6.7         2.5          5.8         1.8  virginica
## 124          6.7         3.0          5.0         1.7 versicolor
## 125          6.7         3.0          5.2         2.3  virginica
## 126          6.7         3.1          4.4         1.4 versicolor
## 127          6.7         3.1          4.7         1.5 versicolor
## 128          6.7         3.1          5.6         2.4  virginica
## 129          6.7         3.3          5.7         2.1  virginica
## 130          6.7         3.3          5.7         2.5  virginica
## 131          6.8         2.8          4.8         1.4 versicolor
## 132          6.8         3.0          5.5         2.1  virginica
## 133          6.8         3.2          5.9         2.3  virginica
## 134          6.9         3.1          4.9         1.5 versicolor
## 135          6.9         3.1          5.4         2.1  virginica
## 136          6.9         3.1          5.1         2.3  virginica
## 137          6.9         3.2          5.7         2.3  virginica
## 138          7.0         3.2          4.7         1.4 versicolor
## 139          7.1         3.0          5.9         2.1  virginica
## 140          7.2         3.0          5.8         1.6  virginica
## 141          7.2         3.2          6.0         1.8  virginica
## 142          7.2         3.6          6.1         2.5  virginica
## 143          7.3         2.9          6.3         1.8  virginica
## 144          7.4         2.8          6.1         1.9  virginica
## 145          7.6         3.0          6.6         2.1  virginica
## 146          7.7         2.6          6.9         2.3  virginica
## 147          7.7         2.8          6.7         2.0  virginica
## 148          7.7         3.0          6.1         2.3  virginica
## 149          7.7         3.8          6.7         2.2  virginica
## 150          7.9         3.8          6.4         2.0  virginica</code></pre>
<pre class="r"><code>iris %&gt;% arrange(desc(Sepal.Length))</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            7.9         3.8          6.4         2.0  virginica
## 2            7.7         3.8          6.7         2.2  virginica
## 3            7.7         2.6          6.9         2.3  virginica
## 4            7.7         2.8          6.7         2.0  virginica
## 5            7.7         3.0          6.1         2.3  virginica
## 6            7.6         3.0          6.6         2.1  virginica
## 7            7.4         2.8          6.1         1.9  virginica
## 8            7.3         2.9          6.3         1.8  virginica
## 9            7.2         3.6          6.1         2.5  virginica
## 10           7.2         3.2          6.0         1.8  virginica
## 11           7.2         3.0          5.8         1.6  virginica
## 12           7.1         3.0          5.9         2.1  virginica
## 13           7.0         3.2          4.7         1.4 versicolor
## 14           6.9         3.1          4.9         1.5 versicolor
## 15           6.9         3.2          5.7         2.3  virginica
## 16           6.9         3.1          5.4         2.1  virginica
## 17           6.9         3.1          5.1         2.3  virginica
## 18           6.8         2.8          4.8         1.4 versicolor
## 19           6.8         3.0          5.5         2.1  virginica
## 20           6.8         3.2          5.9         2.3  virginica
## 21           6.7         3.1          4.4         1.4 versicolor
## 22           6.7         3.0          5.0         1.7 versicolor
## 23           6.7         3.1          4.7         1.5 versicolor
## 24           6.7         2.5          5.8         1.8  virginica
## 25           6.7         3.3          5.7         2.1  virginica
## 26           6.7         3.1          5.6         2.4  virginica
## 27           6.7         3.3          5.7         2.5  virginica
## 28           6.7         3.0          5.2         2.3  virginica
## 29           6.6         2.9          4.6         1.3 versicolor
## 30           6.6         3.0          4.4         1.4 versicolor
## 31           6.5         2.8          4.6         1.5 versicolor
## 32           6.5         3.0          5.8         2.2  virginica
## 33           6.5         3.2          5.1         2.0  virginica
## 34           6.5         3.0          5.5         1.8  virginica
## 35           6.5         3.0          5.2         2.0  virginica
## 36           6.4         3.2          4.5         1.5 versicolor
## 37           6.4         2.9          4.3         1.3 versicolor
## 38           6.4         2.7          5.3         1.9  virginica
## 39           6.4         3.2          5.3         2.3  virginica
## 40           6.4         2.8          5.6         2.1  virginica
## 41           6.4         2.8          5.6         2.2  virginica
## 42           6.4         3.1          5.5         1.8  virginica
## 43           6.3         3.3          4.7         1.6 versicolor
## 44           6.3         2.5          4.9         1.5 versicolor
## 45           6.3         2.3          4.4         1.3 versicolor
## 46           6.3         3.3          6.0         2.5  virginica
## 47           6.3         2.9          5.6         1.8  virginica
## 48           6.3         2.7          4.9         1.8  virginica
## 49           6.3         2.8          5.1         1.5  virginica
## 50           6.3         3.4          5.6         2.4  virginica
## 51           6.3         2.5          5.0         1.9  virginica
## 52           6.2         2.2          4.5         1.5 versicolor
## 53           6.2         2.9          4.3         1.3 versicolor
## 54           6.2         2.8          4.8         1.8  virginica
## 55           6.2         3.4          5.4         2.3  virginica
## 56           6.1         2.9          4.7         1.4 versicolor
## 57           6.1         2.8          4.0         1.3 versicolor
## 58           6.1         2.8          4.7         1.2 versicolor
## 59           6.1         3.0          4.6         1.4 versicolor
## 60           6.1         3.0          4.9         1.8  virginica
## 61           6.1         2.6          5.6         1.4  virginica
## 62           6.0         2.2          4.0         1.0 versicolor
## 63           6.0         2.9          4.5         1.5 versicolor
## 64           6.0         2.7          5.1         1.6 versicolor
## 65           6.0         3.4          4.5         1.6 versicolor
## 66           6.0         2.2          5.0         1.5  virginica
## 67           6.0         3.0          4.8         1.8  virginica
## 68           5.9         3.0          4.2         1.5 versicolor
## 69           5.9         3.2          4.8         1.8 versicolor
## 70           5.9         3.0          5.1         1.8  virginica
## 71           5.8         4.0          1.2         0.2     setosa
## 72           5.8         2.7          4.1         1.0 versicolor
## 73           5.8         2.7          3.9         1.2 versicolor
## 74           5.8         2.6          4.0         1.2 versicolor
## 75           5.8         2.7          5.1         1.9  virginica
## 76           5.8         2.8          5.1         2.4  virginica
## 77           5.8         2.7          5.1         1.9  virginica
## 78           5.7         4.4          1.5         0.4     setosa
## 79           5.7         3.8          1.7         0.3     setosa
## 80           5.7         2.8          4.5         1.3 versicolor
## 81           5.7         2.6          3.5         1.0 versicolor
## 82           5.7         3.0          4.2         1.2 versicolor
## 83           5.7         2.9          4.2         1.3 versicolor
## 84           5.7         2.8          4.1         1.3 versicolor
## 85           5.7         2.5          5.0         2.0  virginica
## 86           5.6         2.9          3.6         1.3 versicolor
## 87           5.6         3.0          4.5         1.5 versicolor
## 88           5.6         2.5          3.9         1.1 versicolor
## 89           5.6         3.0          4.1         1.3 versicolor
## 90           5.6         2.7          4.2         1.3 versicolor
## 91           5.6         2.8          4.9         2.0  virginica
## 92           5.5         4.2          1.4         0.2     setosa
## 93           5.5         3.5          1.3         0.2     setosa
## 94           5.5         2.3          4.0         1.3 versicolor
## 95           5.5         2.4          3.8         1.1 versicolor
## 96           5.5         2.4          3.7         1.0 versicolor
## 97           5.5         2.5          4.0         1.3 versicolor
## 98           5.5         2.6          4.4         1.2 versicolor
## 99           5.4         3.9          1.7         0.4     setosa
## 100          5.4         3.7          1.5         0.2     setosa
## 101          5.4         3.9          1.3         0.4     setosa
## 102          5.4         3.4          1.7         0.2     setosa
## 103          5.4         3.4          1.5         0.4     setosa
## 104          5.4         3.0          4.5         1.5 versicolor
## 105          5.3         3.7          1.5         0.2     setosa
## 106          5.2         3.5          1.5         0.2     setosa
## 107          5.2         3.4          1.4         0.2     setosa
## 108          5.2         4.1          1.5         0.1     setosa
## 109          5.2         2.7          3.9         1.4 versicolor
## 110          5.1         3.5          1.4         0.2     setosa
## 111          5.1         3.5          1.4         0.3     setosa
## 112          5.1         3.8          1.5         0.3     setosa
## 113          5.1         3.7          1.5         0.4     setosa
## 114          5.1         3.3          1.7         0.5     setosa
## 115          5.1         3.4          1.5         0.2     setosa
## 116          5.1         3.8          1.9         0.4     setosa
## 117          5.1         3.8          1.6         0.2     setosa
## 118          5.1         2.5          3.0         1.1 versicolor
## 119          5.0         3.6          1.4         0.2     setosa
## 120          5.0         3.4          1.5         0.2     setosa
## 121          5.0         3.0          1.6         0.2     setosa
## 122          5.0         3.4          1.6         0.4     setosa
## 123          5.0         3.2          1.2         0.2     setosa
## 124          5.0         3.5          1.3         0.3     setosa
## 125          5.0         3.5          1.6         0.6     setosa
## 126          5.0         3.3          1.4         0.2     setosa
## 127          5.0         2.0          3.5         1.0 versicolor
## 128          5.0         2.3          3.3         1.0 versicolor
## 129          4.9         3.0          1.4         0.2     setosa
## 130          4.9         3.1          1.5         0.1     setosa
## 131          4.9         3.1          1.5         0.2     setosa
## 132          4.9         3.6          1.4         0.1     setosa
## 133          4.9         2.4          3.3         1.0 versicolor
## 134          4.9         2.5          4.5         1.7  virginica
## 135          4.8         3.4          1.6         0.2     setosa
## 136          4.8         3.0          1.4         0.1     setosa
## 137          4.8         3.4          1.9         0.2     setosa
## 138          4.8         3.1          1.6         0.2     setosa
## 139          4.8         3.0          1.4         0.3     setosa
## 140          4.7         3.2          1.3         0.2     setosa
## 141          4.7         3.2          1.6         0.2     setosa
## 142          4.6         3.1          1.5         0.2     setosa
## 143          4.6         3.4          1.4         0.3     setosa
## 144          4.6         3.6          1.0         0.2     setosa
## 145          4.6         3.2          1.4         0.2     setosa
## 146          4.5         2.3          1.3         0.3     setosa
## 147          4.4         2.9          1.4         0.2     setosa
## 148          4.4         3.0          1.3         0.2     setosa
## 149          4.4         3.2          1.3         0.2     setosa
## 150          4.3         3.0          1.1         0.1     setosa</code></pre>
<ul>
<li>ggplot2</li>
</ul>
<pre class="r"><code>## ggplot2
## =&gt; data + geom + aesthetics
## geom_point, geom_histogram, geom_line, geom_boxplot, geom_violin

## Name conflicts in package functions (e.g. filter and lag in tidyverse)
?filter</code></pre>
<pre><code>## Help on topic &#39;filter&#39; was found in the following packages:
## 
##   Package               Library
##   stats                 /Library/Frameworks/R.framework/Versions/3.5/Resources/library
##   dplyr                 /Library/Frameworks/R.framework/Versions/3.5/Resources/library
## 
## 
## Using the first match ...</code></pre>
<pre class="r"><code>dplyr::filter</code></pre>
<pre><code>## function (.data, ...) 
## {
##     UseMethod(&quot;filter&quot;)
## }
## &lt;bytecode: 0x7f7fd896d100&gt;
## &lt;environment: namespace:dplyr&gt;</code></pre>
<pre class="r"><code>stats::filter</code></pre>
<pre><code>## function (x, filter, method = c(&quot;convolution&quot;, &quot;recursive&quot;), 
##     sides = 2L, circular = FALSE, init = NULL) 
## {
##     method &lt;- match.arg(method)
##     x &lt;- as.ts(x)
##     storage.mode(x) &lt;- &quot;double&quot;
##     xtsp &lt;- tsp(x)
##     n &lt;- as.integer(NROW(x))
##     if (is.na(n)) 
##         stop(gettextf(&quot;invalid value of %s&quot;, &quot;NROW(x)&quot;), domain = NA)
##     nser &lt;- NCOL(x)
##     filter &lt;- as.double(filter)
##     nfilt &lt;- as.integer(length(filter))
##     if (is.na(nfilt)) 
##         stop(gettextf(&quot;invalid value of %s&quot;, &quot;length(filter)&quot;), 
##             domain = NA)
##     if (anyNA(filter)) 
##         stop(&quot;missing values in &#39;filter&#39;&quot;)
##     if (method == &quot;convolution&quot;) {
##         if (nfilt &gt; n) 
##             stop(&quot;&#39;filter&#39; is longer than time series&quot;)
##         sides &lt;- as.integer(sides)
##         if (is.na(sides) || (sides != 1L &amp;&amp; sides != 2L)) 
##             stop(&quot;argument &#39;sides&#39; must be 1 or 2&quot;)
##         circular &lt;- as.logical(circular)
##         if (is.na(circular)) 
##             stop(&quot;&#39;circular&#39; must be logical and not NA&quot;)
##         if (is.matrix(x)) {
##             y &lt;- matrix(NA, n, nser)
##             for (i in seq_len(nser)) y[, i] &lt;- .Call(C_cfilter, 
##                 x[, i], filter, sides, circular)
##         }
##         else y &lt;- .Call(C_cfilter, x, filter, sides, circular)
##     }
##     else {
##         if (missing(init)) {
##             init &lt;- matrix(0, nfilt, nser)
##         }
##         else {
##             ni &lt;- NROW(init)
##             if (ni != nfilt) 
##                 stop(&quot;length of &#39;init&#39; must equal length of &#39;filter&#39;&quot;)
##             if (NCOL(init) != 1L &amp;&amp; NCOL(init) != nser) {
##                 stop(sprintf(ngettext(nser, &quot;&#39;init&#39; must have %d column&quot;, 
##                   &quot;&#39;init&#39; must have 1 or %d columns&quot;, domain = &quot;R-stats&quot;), 
##                   nser), domain = NA)
##             }
##             if (!is.matrix(init)) 
##                 dim(init) &lt;- c(nfilt, nser)
##         }
##         ind &lt;- seq_len(nfilt)
##         if (is.matrix(x)) {
##             y &lt;- matrix(NA, n, nser)
##             for (i in seq_len(nser)) y[, i] &lt;- .Call(C_rfilter, 
##                 x[, i], filter, c(rev(init[, i]), double(n)))[-ind]
##         }
##         else y &lt;- .Call(C_rfilter, x, filter, c(rev(init[, 1L]), 
##             double(n)))[-ind]
##     }
##     tsp(y) &lt;- xtsp
##     class(y) &lt;- if (nser &gt; 1L) 
##         c(&quot;mts&quot;, &quot;ts&quot;)
##     else &quot;ts&quot;
##     y
## }
## &lt;bytecode: 0x7f7fde1b3070&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
<pre class="r"><code>my_filter &lt;- dplyr::filter
filter &lt;- dplyr::filter

#=============================================================
## Back to ggplot2!
#=============================================================

## ggplot(data = &lt;DATA&gt;) +
##   &lt;GEOM_FUNCTION&gt;(
##     mapping = aes(&lt;MAPPINGS&gt;),
##     stat = &lt;STAT&gt;,
##     position = &lt;POSITION&gt;
##   ) +
##   &lt;COORDINATE_FUNCTION&gt; +
##   &lt;FACET_FUNCTION&gt;</code></pre>
<pre class="r"><code>#=============================================================
## ggplot2: Statistical transformations
#=============================================================

library(tidyverse)
data(diamonds)

## What is plotted here? Where does count come from?
## Histograms, barplots, frequency polygons, smoothers, boxplots, ...
ggplot(diamonds) +
  geom_bar(aes(x = cut))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>ggplot(diamonds) +
  stat_count(aes(x = cut))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>## We can override default stat for a given geom
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y = ..prop.., group = 1))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>## What happens if we don&#39;t set group = 1 above?
## What is wrong with the following two graphs?
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y = ..prop..))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = color, y = ..prop..))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y = ..prop..))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<pre class="r"><code>## We can even explicitly use stat_## instead of the geom
## By default, each stat is associated with a geom and vice versa
ggplot(data = diamonds) +
  stat_count(mapping = aes(x = cut))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre class="r"><code>## Stacked versus side-by-side barplots
ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity), position=&quot;fill&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity), position=&quot;dodge&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre class="r"><code>## geom_smooth: What variables does stat_smooth compute? 
## What parameters control its behavior?

ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
  geom_point() +
  geom_smooth(aes(fill=cut), alpha=0.5)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
  geom_point() +
  geom_smooth(aes(fill=cut), alpha=0.5, method=&quot;lm&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code>  # ?geom_smooth</code></pre>
<ul>
<li>other tricks</li>
</ul>
<pre class="r"><code>#=============================================================
## ggplot2: Some other tricks
#=============================================================

## What to do about overplotting?
## Look at the parameters to control the amount of jittering
data(mpg)
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), position = &quot;jitter&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_jitter(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_count(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-11-4.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), alpha=0.25)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-11-5.png" width="672" /></p>
<pre class="r"><code>## Facets: smaller plots that display a subset of the data
## Useful for exploring conditional relationships and large data
## facet_wrap
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(~trans)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>## What is the difference between facet_wrap and facet_grid?
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_wrap(~trans)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>## What happens if you facet on a continuous variable?

ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_wrap(~cty)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>## coordinates in ggplot: can flip axes with coord_flip
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  coord_flip()</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r"><code>## Saving figures: ggsave
g &lt;- ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  coord_flip()
ggsave(g, filename=&quot;first_ggplot.pdf&quot;)</code></pre>
<pre><code>## Saving 7 x 5 in image</code></pre>
<pre class="r"><code>ggsave(filename=&quot;first_ggplot.pdf&quot;)  ## Save last plot</code></pre>
<pre><code>## Saving 7 x 5 in image</code></pre>
<pre class="r"><code>## Combining ggplot2 figures
# install.packages(&quot;cowplot&quot;)  ## Only do this once!
library(cowplot)</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre class="r"><code>plot_grid(g, g, labels=c(&quot;A&quot;,&quot;B&quot;))</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="in-class" class="section level2">
<h2>In class</h2>
<pre class="r"><code>#-------------------------------------------------------------
## In class: 
## Reproduce plots from example1_ggplot2.pdf, example2_ggplot2.pdf
#-------------------------------------------------------------


#=============================================================
## ggplot2 + forcats: Factors and group ordering
#=============================================================

## Working with factors and group order in ggplot: forcats
# install.packages(&quot;forcats&quot;)  ## not explicitly part of the tidyverse
library(forcats)

colors &lt;- c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;,&quot;green&quot;,&quot;red&quot;,&quot;blue&quot;,&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;)
class(colors)</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<pre class="r"><code>colors &lt;- factor(colors)
print(colors)</code></pre>
<pre><code>## [1] red   blue  green green red   blue  red   green blue 
## Levels: blue green red</code></pre>
<pre class="r"><code>class(colors)</code></pre>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<pre class="r"><code># Each color is a level, and underlying each level is an integer associated with that
# level; red = 3, green = 2, blue = 1. The order of the levels is assigned
# alphabetically to the integer: b = 1, g = 2, r = 3.
colors &lt;- factor(colors, levels = c(&quot;red&quot;,&quot;blue&quot;, &quot;green&quot;))
print(colors)</code></pre>
<pre><code>## [1] red   blue  green green red   blue  red   green blue 
## Levels: red blue green</code></pre>
<pre class="r"><code>data(airquality)
airquality$Month &lt;- factor(airquality$Month)
levels(airquality$Month)</code></pre>
<pre><code>## [1] &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot;</code></pre>
<pre class="r"><code>ggplot(airquality, aes(Month, Temp)) +
  geom_boxplot(aes(fill = Month)) +
  ggtitle(label = &quot;Daily Temperatures Aggregated by Month&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># ## Renaming factor levels: fct_recode
airquality$Month &lt;- fct_recode(airquality$Month,
                               May=&#39;5&#39;, June=&#39;6&#39;, July=&#39;7&#39;, Aug=&#39;8&#39;, Sept=&#39;9&#39;)
ggplot(airquality, aes(Month, Temp)) +
  geom_boxplot(aes(fill = Month)) +
  ggtitle(label = &quot;Daily Temperatures Aggregated by Month&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code># ## Reverse factor order: fct_reverse
ggplot(airquality, aes(fct_rev(Month), Temp)) +
  geom_boxplot(aes(fill = Month)) +
  labs(x = &quot;Month&quot;) +
  ggtitle(label = &quot;Our plot now has the x-axis in reverse order&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code># ## Factor relevel
airquality$Month &lt;- fct_relevel(airquality$Month, &#39;Sept&#39;, &#39;July&#39;, &#39;May&#39;, &#39;Aug&#39;, &#39;June&#39;)
levels(airquality$Month)</code></pre>
<pre><code>## [1] &quot;Sept&quot; &quot;July&quot; &quot;May&quot;  &quot;Aug&quot;  &quot;June&quot;</code></pre>
<pre class="r"><code>ggplot(airquality, aes(Month, Temp)) +
  geom_boxplot(aes(fill = Month)) +
  ggtitle(label = &quot;Notice how the order of the level &#39;Month&#39; has changed&quot;)</code></pre>
<p><img src="lecture5_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># ## And we can also order factors according to another variable
data(mtcars)
mtcars$model &lt;- factor(row.names(mtcars))
class(mtcars$model)
ggplot(mtcars, aes(mpg, model)) +
  geom_point() +
  ggtitle(label = &quot;MPG vs. Car Model&quot;)
ggplot(mtcars, aes(mpg, fct_reorder(f = model, x = mpg))) +
  geom_point() +
  labs(y = &quot;model&quot;) +
  ggtitle(label = &quot;Better comparison by reordering levels based on mpg values!&quot;) +
  theme(plot.title = element_text(size = 10, face = &#39;bold&#39;))</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
