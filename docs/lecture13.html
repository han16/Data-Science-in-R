<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Shengtong" />

<meta name="date" content="2018-11-15" />

<title>lecture13</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Code</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://han16.github.io/Data-Science-in-R/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">lecture13</h1>
<h4 class="author"><em>Shengtong</em></h4>
<h4 class="date"><em>2018-11-15</em></h4>

</div>


<p><strong>Last updated:</strong> 2018-11-15</p>
<strong>workflowr checks:</strong> <small>(Click a bullet for more information)</small>
<ul>
<li>
<p><details> <summary> <strong style="color:red;">✖</strong> <strong>R Markdown file:</strong> uncommitted changes </summary> The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Environment:</strong> empty </summary></p>
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Seed:</strong> <code>set.seed(20181026)</code> </summary></p>
<p>The command <code>set.seed(20181026)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Session information:</strong> recorded </summary></p>
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</details>
</li>
<li>
<p><details> <summary> <strong style="color:blue;">✔</strong> <strong>Repository version:</strong> <a href="https://github.com/han16/Data-Science-in-R/tree/655b1827bea19e155bfe944c83cade0e0efdb0f0" target="_blank">655b182</a> </summary></p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
<pre><code>
Ignored files:
    Ignored:    analysis/.Rhistory
    Ignored:    analysis/figure/
    Ignored:    analysis/shiny/.Rhistory
    Ignored:    docs/shiny/.Rhistory

Unstaged changes:
    Modified:   analysis/lecture13.Rmd

</code></pre>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes. </details>
</li>
</ul>
<details> <summary> <small><strong>Expand here to see past versions:</strong></small> </summary>
<ul>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/han16/Data-Science-in-R/blob/655b1827bea19e155bfe944c83cade0e0efdb0f0/analysis/lecture13.Rmd" target="_blank">655b182</a>
</td>
<td style="text-align:left;">
han16
</td>
<td style="text-align:left;">
2018-11-15
</td>
<td style="text-align:left;">
Nov152018
</td>
</tr>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/han16/Data-Science-in-R/655b1827bea19e155bfe944c83cade0e0efdb0f0/docs/lecture13.html" target="_blank">655b182</a>
</td>
<td style="text-align:left;">
han16
</td>
<td style="text-align:left;">
2018-11-15
</td>
<td style="text-align:left;">
Nov152018
</td>
</tr>
</tbody>
</table>
</ul>
<p></details></p>
<hr />
<pre class="r"><code>########################################################
#### Project presentations
####
#### Final take-home exam next week
######################################################

#=============================================================
## Regular expressions (Regex)
# Extra resource: https://regexr.com/
#=============================================================

## Character data can be hard to deal with!
## Regular expressions = way to express patterns to match in text or 
##   search and replace
##
## Basic tasks:
## (1) Study a single character vector 
##  - How long are strings?
##  - Presence/absence of literal string
## (2) Operate on single character vector
##  - Keep/discard elements that contain a string
##  - Split into two or more vectors using a delimiter
##  - Snip out pieces of strings based on position
## (3) Operate on two or more character vectors
##  - Glue them together element-wise

#-----------------------------------------------------------------
## First: let&#39;s look at regex-free string manipulation in R
#-----------------------------------------------------------------

## We will use the stringr package (part of the tidyverse)
##   Main functions start with str_*
## Note: base functions include nchar(), strsplit(), substr(), grep(), ...

library(tidyverse)</code></pre>
<pre><code>-- Attaching packages ------------------------------------------------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>v ggplot2 3.1.0     v purrr   0.2.5
v tibble  1.4.2     v dplyr   0.7.7
v tidyr   0.8.2     v stringr 1.3.1
v readr   1.1.1     v forcats 0.3.0</code></pre>
<pre><code>-- Conflicts ---------------------------------------------------------------------------------- tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>## fruit, words, sentences
## =&gt; Which fruits actually contain the word &quot;fruit&quot;?
str_detect(fruit, pattern = &quot;fruit&quot;)</code></pre>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[12]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[23] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[34] FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE
[45] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[56] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[67] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
[78] FALSE  TRUE FALSE</code></pre>
<pre class="r"><code>str_subset(fruit, pattern = &quot;fruit&quot;)</code></pre>
<pre><code>[1] &quot;breadfruit&quot;   &quot;dragonfruit&quot;  &quot;grapefruit&quot;   &quot;jackfruit&quot;   
[5] &quot;kiwi fruit&quot;   &quot;passionfruit&quot; &quot;star fruit&quot;   &quot;ugli fruit&quot;  </code></pre>
<pre class="r"><code>str_subset(fruit, pattern = &quot;Fruit&quot;)  ## Note: case sensitive</code></pre>
<pre><code>character(0)</code></pre>
<pre class="r"><code>my_fruit &lt;- str_subset(fruit, pattern = &quot;fruit&quot;)</code></pre>
<pre class="r"><code>## Split on a delimiter
str_split(my_fruit, pattern = &quot; &quot;) ## Why is this a list?</code></pre>
<pre><code>[[1]]
[1] &quot;breadfruit&quot;

[[2]]
[1] &quot;dragonfruit&quot;

[[3]]
[1] &quot;grapefruit&quot;

[[4]]
[1] &quot;jackfruit&quot;

[[5]]
[1] &quot;kiwi&quot;  &quot;fruit&quot;

[[6]]
[1] &quot;passionfruit&quot;

[[7]]
[1] &quot;star&quot;  &quot;fruit&quot;

[[8]]
[1] &quot;ugli&quot;  &quot;fruit&quot;</code></pre>
<pre class="r"><code>str_split_fixed(my_fruit, pattern = &quot; &quot;, n = 2)</code></pre>
<pre><code>     [,1]           [,2]   
[1,] &quot;breadfruit&quot;   &quot;&quot;     
[2,] &quot;dragonfruit&quot;  &quot;&quot;     
[3,] &quot;grapefruit&quot;   &quot;&quot;     
[4,] &quot;jackfruit&quot;    &quot;&quot;     
[5,] &quot;kiwi&quot;         &quot;fruit&quot;
[6,] &quot;passionfruit&quot; &quot;&quot;     
[7,] &quot;star&quot;         &quot;fruit&quot;
[8,] &quot;ugli&quot;         &quot;fruit&quot;</code></pre>
<pre class="r"><code>## Remember, we already knew how to do this with tidyr commands:
my_fruit_df &lt;- data.frame(my_fruit)
my_fruit_df %&gt;% 
  separate(my_fruit, into = c(&quot;pre&quot;, &quot;post&quot;), sep = &quot; &quot;)</code></pre>
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 5 rows [1,
2, 3, 4, 6].</code></pre>
<pre><code>           pre  post
1   breadfruit  &lt;NA&gt;
2  dragonfruit  &lt;NA&gt;
3   grapefruit  &lt;NA&gt;
4    jackfruit  &lt;NA&gt;
5         kiwi fruit
6 passionfruit  &lt;NA&gt;
7         star fruit
8         ugli fruit</code></pre>
<pre class="r"><code>## Substring extraction and replacement
length(my_fruit)</code></pre>
<pre><code>[1] 8</code></pre>
<pre class="r"><code>str_length(my_fruit)</code></pre>
<pre><code>[1] 10 11 10  9 10 12 10 10</code></pre>
<pre class="r"><code>head(fruit) %&gt;% str_sub(1, 3)</code></pre>
<pre><code>[1] &quot;app&quot; &quot;apr&quot; &quot;avo&quot; &quot;ban&quot; &quot;bel&quot; &quot;bil&quot;</code></pre>
<pre class="r"><code>tibble(fruit) %&gt;% 
  head() %&gt;% 
  mutate(snip = str_sub(fruit, 1:6, 3:8))  ## This can be vectorized</code></pre>
<pre><code># A tibble: 6 x 2
  fruit       snip 
  &lt;chr&gt;       &lt;chr&gt;
1 apple       app  
2 apricot     pri  
3 avocado     oca  
4 banana      ana  
5 bell pepper &quot; pe&quot;
6 bilberry    rry  </code></pre>
<pre class="r"><code>x &lt;- head(fruit, 3)
str_sub(x, 1, 3) &lt;- &quot;AAA&quot;  ## Can also be used for assignment
x</code></pre>
<pre><code>[1] &quot;AAAle&quot;   &quot;AAAicot&quot; &quot;AAAcado&quot;</code></pre>
<pre class="r"><code>## Collapse a vector to a single string
head(fruit) %&gt;% 
  str_c(collapse = &quot;, &quot;)</code></pre>
<pre><code>[1] &quot;apple, apricot, avocado, banana, bell pepper, bilberry&quot;</code></pre>
<pre class="r"><code>## Or create a new vector by collapsing element-wise 
## =&gt; we can also do this with tidyr::unite()
str_c(fruit[1:4], fruit[5:8], sep = &quot; &amp; &quot;)</code></pre>
<pre><code>[1] &quot;apple &amp; bell pepper&quot;   &quot;apricot &amp; bilberry&quot;    &quot;avocado &amp; blackberry&quot; 
[4] &quot;banana &amp; blackcurrant&quot;</code></pre>
<pre class="r"><code>## Replace a substring
str_replace(my_fruit, pattern = &quot;fruit&quot;, replacement = &quot;THINGY&quot;)</code></pre>
<pre><code>[1] &quot;breadTHINGY&quot;   &quot;dragonTHINGY&quot;  &quot;grapeTHINGY&quot;   &quot;jackTHINGY&quot;   
[5] &quot;kiwi THINGY&quot;   &quot;passionTHINGY&quot; &quot;star THINGY&quot;   &quot;ugli THINGY&quot;  </code></pre>
<pre class="r"><code>## Special case is str_replace_na
x[1] &lt;- NA
str_replace_na(x, &quot;UNKNOWN!&quot;)</code></pre>
<pre><code>[1] &quot;UNKNOWN!&quot; &quot;AAAicot&quot;  &quot;AAAcado&quot; </code></pre>
<div id="now-regular-expressions-in-r" class="section level2">
<h2>Now: regular expressions in R</h2>
<pre class="r"><code>## Let&#39;s use the gapminder data for this part

library(gapminder)
countries &lt;- levels(gapminder$country)

## Frequently you can&#39;t do your character task with a fixed string but 
##  need to use a pattern instead =&gt; regex is standard way to deal with this!

## Use metacharacters:
## . = any standard character except a newline
## \n = newline
## \d = [:digit:] = digit
## [:lower:], [:upper:]: lowercase and uppercase

str_subset(countries, pattern = &quot;i.a&quot;)  ## Note: case sensitive! Italy doesn&#39;t match...</code></pre>
<pre><code> [1] &quot;Argentina&quot;                &quot;Bosnia and Herzegovina&quot;  
 [3] &quot;Burkina Faso&quot;             &quot;Central African Republic&quot;
 [5] &quot;China&quot;                    &quot;Costa Rica&quot;              
 [7] &quot;Dominican Republic&quot;       &quot;Hong Kong, China&quot;        
 [9] &quot;Jamaica&quot;                  &quot;Mauritania&quot;              
[11] &quot;Nicaragua&quot;                &quot;South Africa&quot;            
[13] &quot;Swaziland&quot;                &quot;Taiwan&quot;                  
[15] &quot;Thailand&quot;                 &quot;Trinidad and Tobago&quot;     </code></pre>
<pre class="r"><code>str_subset(countries, pattern = regex(&quot;i.a&quot;))</code></pre>
<pre><code> [1] &quot;Argentina&quot;                &quot;Bosnia and Herzegovina&quot;  
 [3] &quot;Burkina Faso&quot;             &quot;Central African Republic&quot;
 [5] &quot;China&quot;                    &quot;Costa Rica&quot;              
 [7] &quot;Dominican Republic&quot;       &quot;Hong Kong, China&quot;        
 [9] &quot;Jamaica&quot;                  &quot;Mauritania&quot;              
[11] &quot;Nicaragua&quot;                &quot;South Africa&quot;            
[13] &quot;Swaziland&quot;                &quot;Taiwan&quot;                  
[15] &quot;Thailand&quot;                 &quot;Trinidad and Tobago&quot;     </code></pre>
<pre class="r"><code>str_subset(countries, pattern = &quot;I.a&quot;)</code></pre>
<pre><code>[1] &quot;Iran&quot;  &quot;Iraq&quot;  &quot;Italy&quot;</code></pre>
<pre class="r"><code>## Anchors specify where an expression must occur within a string
## ^ = start
## $ = end

str_subset(countries, pattern = &quot;i.a$&quot;)</code></pre>
<pre><code>[1] &quot;Argentina&quot;              &quot;Bosnia and Herzegovina&quot;
[3] &quot;China&quot;                  &quot;Costa Rica&quot;            
[5] &quot;Hong Kong, China&quot;       &quot;Jamaica&quot;               
[7] &quot;South Africa&quot;          </code></pre>
<pre class="r"><code>str_subset(my_fruit, pattern = &quot;d&quot;)</code></pre>
<pre><code>[1] &quot;breadfruit&quot;  &quot;dragonfruit&quot;</code></pre>
<pre class="r"><code>str_subset(my_fruit, pattern = &quot;^d&quot;)</code></pre>
<pre><code>[1] &quot;dragonfruit&quot;</code></pre>
<pre class="r"><code>## Some metacharacters need &quot;escaping&quot; = an additional backslash
## This is the case for any characters that would otherwise have a special interpretation
## e.g. $ * + . ? [ ] ^ { } | ( ) \
## \\b = word boundary
## \\B = NOT a word boundary

str_subset(fruit, pattern = &quot;melon&quot;)</code></pre>
<pre><code>[1] &quot;canary melon&quot; &quot;rock melon&quot;   &quot;watermelon&quot;  </code></pre>
<pre class="r"><code>str_subset(fruit, pattern = &quot;bmelon&quot;)</code></pre>
<pre><code>character(0)</code></pre>
<pre class="r"><code>str_subset(fruit, pattern = &quot;\\Bmelon&quot;)</code></pre>
<pre><code>[1] &quot;watermelon&quot;</code></pre>
<pre class="r"><code>str_subset(countries, pattern = &quot;.&quot;) ## This doesn&#39;t work because . is a special character!</code></pre>
<pre><code>  [1] &quot;Afghanistan&quot;              &quot;Albania&quot;                 
  [3] &quot;Algeria&quot;                  &quot;Angola&quot;                  
  [5] &quot;Argentina&quot;                &quot;Australia&quot;               
  [7] &quot;Austria&quot;                  &quot;Bahrain&quot;                 
  [9] &quot;Bangladesh&quot;               &quot;Belgium&quot;                 
 [11] &quot;Benin&quot;                    &quot;Bolivia&quot;                 
 [13] &quot;Bosnia and Herzegovina&quot;   &quot;Botswana&quot;                
 [15] &quot;Brazil&quot;                   &quot;Bulgaria&quot;                
 [17] &quot;Burkina Faso&quot;             &quot;Burundi&quot;                 
 [19] &quot;Cambodia&quot;                 &quot;Cameroon&quot;                
 [21] &quot;Canada&quot;                   &quot;Central African Republic&quot;
 [23] &quot;Chad&quot;                     &quot;Chile&quot;                   
 [25] &quot;China&quot;                    &quot;Colombia&quot;                
 [27] &quot;Comoros&quot;                  &quot;Congo, Dem. Rep.&quot;        
 [29] &quot;Congo, Rep.&quot;              &quot;Costa Rica&quot;              
 [31] &quot;Cote d&#39;Ivoire&quot;            &quot;Croatia&quot;                 
 [33] &quot;Cuba&quot;                     &quot;Czech Republic&quot;          
 [35] &quot;Denmark&quot;                  &quot;Djibouti&quot;                
 [37] &quot;Dominican Republic&quot;       &quot;Ecuador&quot;                 
 [39] &quot;Egypt&quot;                    &quot;El Salvador&quot;             
 [41] &quot;Equatorial Guinea&quot;        &quot;Eritrea&quot;                 
 [43] &quot;Ethiopia&quot;                 &quot;Finland&quot;                 
 [45] &quot;France&quot;                   &quot;Gabon&quot;                   
 [47] &quot;Gambia&quot;                   &quot;Germany&quot;                 
 [49] &quot;Ghana&quot;                    &quot;Greece&quot;                  
 [51] &quot;Guatemala&quot;                &quot;Guinea&quot;                  
 [53] &quot;Guinea-Bissau&quot;            &quot;Haiti&quot;                   
 [55] &quot;Honduras&quot;                 &quot;Hong Kong, China&quot;        
 [57] &quot;Hungary&quot;                  &quot;Iceland&quot;                 
 [59] &quot;India&quot;                    &quot;Indonesia&quot;               
 [61] &quot;Iran&quot;                     &quot;Iraq&quot;                    
 [63] &quot;Ireland&quot;                  &quot;Israel&quot;                  
 [65] &quot;Italy&quot;                    &quot;Jamaica&quot;                 
 [67] &quot;Japan&quot;                    &quot;Jordan&quot;                  
 [69] &quot;Kenya&quot;                    &quot;Korea, Dem. Rep.&quot;        
 [71] &quot;Korea, Rep.&quot;              &quot;Kuwait&quot;                  
 [73] &quot;Lebanon&quot;                  &quot;Lesotho&quot;                 
 [75] &quot;Liberia&quot;                  &quot;Libya&quot;                   
 [77] &quot;Madagascar&quot;               &quot;Malawi&quot;                  
 [79] &quot;Malaysia&quot;                 &quot;Mali&quot;                    
 [81] &quot;Mauritania&quot;               &quot;Mauritius&quot;               
 [83] &quot;Mexico&quot;                   &quot;Mongolia&quot;                
 [85] &quot;Montenegro&quot;               &quot;Morocco&quot;                 
 [87] &quot;Mozambique&quot;               &quot;Myanmar&quot;                 
 [89] &quot;Namibia&quot;                  &quot;Nepal&quot;                   
 [91] &quot;Netherlands&quot;              &quot;New Zealand&quot;             
 [93] &quot;Nicaragua&quot;                &quot;Niger&quot;                   
 [95] &quot;Nigeria&quot;                  &quot;Norway&quot;                  
 [97] &quot;Oman&quot;                     &quot;Pakistan&quot;                
 [99] &quot;Panama&quot;                   &quot;Paraguay&quot;                
[101] &quot;Peru&quot;                     &quot;Philippines&quot;             
[103] &quot;Poland&quot;                   &quot;Portugal&quot;                
[105] &quot;Puerto Rico&quot;              &quot;Reunion&quot;                 
[107] &quot;Romania&quot;                  &quot;Rwanda&quot;                  
[109] &quot;Sao Tome and Principe&quot;    &quot;Saudi Arabia&quot;            
[111] &quot;Senegal&quot;                  &quot;Serbia&quot;                  
[113] &quot;Sierra Leone&quot;             &quot;Singapore&quot;               
[115] &quot;Slovak Republic&quot;          &quot;Slovenia&quot;                
[117] &quot;Somalia&quot;                  &quot;South Africa&quot;            
[119] &quot;Spain&quot;                    &quot;Sri Lanka&quot;               
[121] &quot;Sudan&quot;                    &quot;Swaziland&quot;               
[123] &quot;Sweden&quot;                   &quot;Switzerland&quot;             
[125] &quot;Syria&quot;                    &quot;Taiwan&quot;                  
[127] &quot;Tanzania&quot;                 &quot;Thailand&quot;                
[129] &quot;Togo&quot;                     &quot;Trinidad and Tobago&quot;     
[131] &quot;Tunisia&quot;                  &quot;Turkey&quot;                  
[133] &quot;Uganda&quot;                   &quot;United Kingdom&quot;          
[135] &quot;United States&quot;            &quot;Uruguay&quot;                 
[137] &quot;Venezuela&quot;                &quot;Vietnam&quot;                 
[139] &quot;West Bank and Gaza&quot;       &quot;Yemen, Rep.&quot;             
[141] &quot;Zambia&quot;                   &quot;Zimbabwe&quot;                </code></pre>
<pre class="r"><code>str_subset(countries, pattern = &quot;\\.&quot;) ## This doesn&#39;t work because . is a special character!</code></pre>
<pre><code>[1] &quot;Congo, Dem. Rep.&quot; &quot;Congo, Rep.&quot;      &quot;Korea, Dem. Rep.&quot;
[4] &quot;Korea, Rep.&quot;      &quot;Yemen, Rep.&quot;     </code></pre>
<pre class="r"><code>x &lt;- c(&quot;whatever&quot;, &quot;X is distributed U[0,1]&quot;)
str_subset(x, pattern = &quot;\\[&quot;)</code></pre>
<pre><code>[1] &quot;X is distributed U[0,1]&quot;</code></pre>
<pre class="r"><code>## | = or
str_subset(fruit, pattern = &quot;apple|berry&quot;)</code></pre>
<pre><code> [1] &quot;apple&quot;       &quot;bilberry&quot;    &quot;blackberry&quot;  &quot;blueberry&quot;   &quot;boysenberry&quot;
 [6] &quot;cloudberry&quot;  &quot;cranberry&quot;   &quot;elderberry&quot;  &quot;goji berry&quot;  &quot;gooseberry&quot; 
[11] &quot;huckleberry&quot; &quot;mulberry&quot;    &quot;pineapple&quot;   &quot;raspberry&quot;   &quot;salal berry&quot;
[16] &quot;strawberry&quot; </code></pre>
<pre class="r"><code>## Character classes are indicated by square brackets
## [...] = one of the characters in this class
## [^...] = NOT one of the characters in this class
str_subset(countries, pattern = &quot;[nls]ia$&quot;)</code></pre>
<pre><code> [1] &quot;Albania&quot;    &quot;Australia&quot;  &quot;Indonesia&quot;  &quot;Malaysia&quot;   &quot;Mauritania&quot;
 [6] &quot;Mongolia&quot;   &quot;Romania&quot;    &quot;Slovenia&quot;   &quot;Somalia&quot;    &quot;Tanzania&quot;  
[11] &quot;Tunisia&quot;   </code></pre>
<pre class="r"><code>str_subset(countries, pattern = &quot;[^nls]ia$&quot;)</code></pre>
<pre><code> [1] &quot;Algeria&quot;      &quot;Austria&quot;      &quot;Bolivia&quot;      &quot;Bulgaria&quot;    
 [5] &quot;Cambodia&quot;     &quot;Colombia&quot;     &quot;Croatia&quot;      &quot;Ethiopia&quot;    
 [9] &quot;Gambia&quot;       &quot;India&quot;        &quot;Liberia&quot;      &quot;Namibia&quot;     
[13] &quot;Nigeria&quot;      &quot;Saudi Arabia&quot; &quot;Serbia&quot;       &quot;Syria&quot;       
[17] &quot;Zambia&quot;      </code></pre>
<pre class="r"><code>## \s = space
## [[:space:]] = space
## [[:punct:]] = punctuation
str_split_fixed(my_fruit, pattern = &quot; &quot;, n = 2)</code></pre>
<pre><code>     [,1]           [,2]   
[1,] &quot;breadfruit&quot;   &quot;&quot;     
[2,] &quot;dragonfruit&quot;  &quot;&quot;     
[3,] &quot;grapefruit&quot;   &quot;&quot;     
[4,] &quot;jackfruit&quot;    &quot;&quot;     
[5,] &quot;kiwi&quot;         &quot;fruit&quot;
[6,] &quot;passionfruit&quot; &quot;&quot;     
[7,] &quot;star&quot;         &quot;fruit&quot;
[8,] &quot;ugli&quot;         &quot;fruit&quot;</code></pre>
<pre class="r"><code>str_split_fixed(my_fruit, pattern = &quot;\\s&quot;, n = 2)</code></pre>
<pre><code>     [,1]           [,2]   
[1,] &quot;breadfruit&quot;   &quot;&quot;     
[2,] &quot;dragonfruit&quot;  &quot;&quot;     
[3,] &quot;grapefruit&quot;   &quot;&quot;     
[4,] &quot;jackfruit&quot;    &quot;&quot;     
[5,] &quot;kiwi&quot;         &quot;fruit&quot;
[6,] &quot;passionfruit&quot; &quot;&quot;     
[7,] &quot;star&quot;         &quot;fruit&quot;
[8,] &quot;ugli&quot;         &quot;fruit&quot;</code></pre>
<pre class="r"><code>str_split_fixed(my_fruit, pattern = &quot;[[:space:]]&quot;, n = 2)</code></pre>
<pre><code>     [,1]           [,2]   
[1,] &quot;breadfruit&quot;   &quot;&quot;     
[2,] &quot;dragonfruit&quot;  &quot;&quot;     
[3,] &quot;grapefruit&quot;   &quot;&quot;     
[4,] &quot;jackfruit&quot;    &quot;&quot;     
[5,] &quot;kiwi&quot;         &quot;fruit&quot;
[6,] &quot;passionfruit&quot; &quot;&quot;     
[7,] &quot;star&quot;         &quot;fruit&quot;
[8,] &quot;ugli&quot;         &quot;fruit&quot;</code></pre>
<pre class="r"><code>str_subset(countries, &quot;[[:punct:]]&quot;)</code></pre>
<pre><code>[1] &quot;Congo, Dem. Rep.&quot; &quot;Congo, Rep.&quot;      &quot;Cote d&#39;Ivoire&quot;   
[4] &quot;Guinea-Bissau&quot;    &quot;Hong Kong, China&quot; &quot;Korea, Dem. Rep.&quot;
[7] &quot;Korea, Rep.&quot;      &quot;Yemen, Rep.&quot;     </code></pre>
<pre class="r"><code>## Quantifiers:
## * = 0 or more
## + = 1 or more
## ? = 0 or 1
## {n} = exactly n
## {n,} = at least n
## {,m} = at most m
## {n,m} = between n and m, inclusive

## Let&#39;s play around with this: how does changing the quantifier change the result?
str_subset(fruit, pattern = &quot;l[^\\s]{2}e&quot;)</code></pre>
<pre><code>[1] &quot;clementine&quot;  &quot;huckleberry&quot; &quot;lime&quot;        &quot;olive&quot;      </code></pre>
<pre class="r"><code>tmp &lt;- c(&quot;file_record_transcript.pdf&quot;,
         &quot;file_07241999.pdf&quot;,
         &quot;testfile_fake.pdf.tmptest&quot;)
str_subset(tmp, pattern = &quot;^(file.*)\\.pdf$&quot;)</code></pre>
<pre><code>[1] &quot;file_record_transcript.pdf&quot; &quot;file_07241999.pdf&quot;         </code></pre>
<pre class="r"><code>str_subset(tmp, pattern = &quot;^file.*[^.pdf]&quot;)</code></pre>
<pre><code>[1] &quot;file_record_transcript.pdf&quot; &quot;file_07241999.pdf&quot;         </code></pre>
<pre class="r"><code>#-----------------------------------------------------------------
## In class: https://regexone.com/lesson/introduction_abcs
##
## Play around with the Million Song Database
## -- Find all song titles with love/loving/lovin&#39;.
## -- Find all artists with punctuation in their names.
#-----------------------------------------------------------------

library(devtools)
install_github(&quot;JoeyBernhardt/singer&quot;)
library(singer) ## Data package with an excerpt from the Million Song Database
places &lt;- unique(singer_locations$city)
song_titles &lt;- singer_locations$title</code></pre>
<pre class="r"><code>#=============================================================
## Sentiment analysis aka opinion mining
## Read this: http://varianceexplained.org/r/trump-tweets/
## And this: http://varianceexplained.org/r/trump-followup/
##
## https://www.tidytextmining.com/
#=============================================================

## Aim: determine the attitude of someone/thing wrt some topic/context/documents/etc
##   (often used by companies to quantify general social media opinion)
## Idea: attribute to each word a score, expressing whether its negative or positive,
##   and sum it up
## Classify polarity (= positive, neutral, negative) or beyond polarity 
##   (angry, sad, happy, ...)


## 1. obtain your text source (website, Twitter, database, PDF document, ...)
## 2. extract documents and move into a corpus
## 3. transformation (convert to lowercase, remove punctuation, remove stopwords, ...)
## 4. extract features
## 5. perform analysis (word frequency, co-occurrrence, document classification/comparison,
##      topic modeling)

#-----------------------------------------------------------------
## Polarity analysis
#-----------------------------------------------------------------

## Now let&#39;s look at the tidy data frame in austen_books()
## -- We will first add a linenumber variable to keep track of original line numbers.
## -- Then let&#39;s use a regex to find where the chapters are.
## -- Then we must break text up into words using unnest_tokens, 
##  remove those not considered interesting (=&quot;stop words&quot;),
##  join text data frame to the vocabulary scores, and do the math!

library(tidytext)
library(janeaustenr)

original_books &lt;- austen_books() %&gt;%
  group_by(book) %&gt;%
  mutate(linenumber = row_number(),
         chapter = cumsum(str_detect(text, 
                                     regex(&quot;^chapter [\\divxlc]&quot;, ignore_case = TRUE)))) %&gt;%
  ungroup()
original_books</code></pre>
<pre class="r"><code>## We then use the unnest_tokens function to return text in one-token-per-row tidy format
tidy_books &lt;- original_books %&gt;%
  unnest_tokens(word, text)

## Now we can use tidyverse data cleaning to remove the &quot;stop words&quot;
data(stop_words)
head(stop_words)
tidy_books &lt;- tidy_books %&gt;%
  anti_join(stop_words)

## And dplyr can tell us about e.g. the most common words in all of Jane Austen&#39;s novels
tidy_books %&gt;%
  group_by(book) %&gt;%
  count(word) %&gt;%
  top_n(1)

## Now need a vocabulary of words for which we have the scores
## Choices: afinn, bing, nrc, loughran
bing &lt;- get_sentiments(&quot;bing&quot;)
get_sentiments(&quot;afinn&quot;)
get_sentiments(&quot;nrc&quot;)


## Now we combine the vocabulary with our tidy text, and count up for pre-defined sections
janeaustensentiment &lt;- tidy_books %&gt;%
  inner_join(bing) %&gt;% 
  count(book, index = linenumber %/% 80, sentiment) %&gt;% 
  spread(sentiment, n, fill = 0) %&gt;% 
  mutate(sentiment = positive - negative)

janeaustensentiment

## And let&#39;s plot this out!
ggplot(janeaustensentiment, aes(index, sentiment, fill = book)) +
  geom_bar(stat = &quot;identity&quot;, show.legend = FALSE) +
  facet_wrap(~book, ncol = 2, scales = &quot;free_x&quot;) +
  theme_minimal(base_size = 13) +
  labs(title = &quot;Sentiment in Jane Austen&#39;s Novels&quot;,
       y = &quot;Sentiment&quot;) +
  scale_x_discrete(expand=c(0.02,0)) +
  theme(strip.text=element_text(hjust=0)) +
  theme(strip.text = element_text(face = &quot;italic&quot;)) +
  theme(axis.title.x=element_blank()) +
  theme(axis.ticks.x=element_blank()) +
  theme(axis.text.x=element_blank())

## Let&#39;s ask another question: What is the most negative chapter of each
##   Jane Austen novel?
## 1. Identify &quot;negative&quot; Bing words
## 2. Group words by chapter, and count the total number of words per chapter
##   (to normalize for differences in length)

bingnegative &lt;- sentiments %&gt;%
  filter(lexicon == &quot;bing&quot;, sentiment == &quot;negative&quot;)

wordcounts &lt;- tidy_books %&gt;%
  group_by(book, chapter) %&gt;%
  summarize(words = n())

tidy_books %&gt;%
  semi_join(bingnegative) %&gt;%
  group_by(book, chapter) %&gt;%
  summarize(negativewords = n()) %&gt;%
  left_join(wordcounts, by = c(&quot;book&quot;, &quot;chapter&quot;)) %&gt;%
  mutate(ratio = negativewords/words) %&gt;%
  filter(chapter != 0) %&gt;%
  top_n(1)

## And what about looking at words that co-occur together? =&gt; Use pair_count
install_github(&quot;dgrtwo/widyr&quot;)
library(widyr)
pride_prejudice_words &lt;- tidy_books %&gt;%
  filter(book == &quot;Pride &amp; Prejudice&quot;)
word_cooccurences &lt;- pride_prejudice_words %&gt;%
  pairwise_count(word, linenumber, sort = TRUE, upper=FALSE)
word_cooccurences

## Now we could plot a network of co-occurring words
library(igraph)
library(ggraph)

set.seed(1813)
word_cooccurences %&gt;%
  filter(n &gt;= 10) %&gt;%
  graph_from_data_frame() %&gt;%
  ggraph(layout = &quot;fr&quot;) +
  geom_edge_link(aes(edge_alpha = n, edge_width = n)) +
  geom_node_point(color = &quot;darkslategray4&quot;, size = 5) +
  geom_node_text(aes(label = name), vjust = 1.8) +
  ggtitle(expression(paste(&quot;Word Network in Jane Austen&#39;s &quot;, 
                           italic(&quot;Pride and Prejudice&quot;)))) +
  theme_void()

## And another book
pride_prejudice_words &lt;- tidy_books %&gt;%
  filter(book == &quot;Emma&quot;)
word_cooccurences &lt;- pride_prejudice_words %&gt;%
  pair_count(linenumber, word, sort = TRUE)
set.seed(2016)
word_cooccurences %&gt;%
  filter(n &gt;= 10) %&gt;%
  graph_from_data_frame() %&gt;%
  ggraph(layout = &quot;fr&quot;) +
  geom_edge_link(aes(edge_alpha = n, edge_width = n)) +
  geom_node_point(color = &quot;plum4&quot;, size = 5) +
  geom_node_text(aes(label = name), vjust = 1.8) +
  ggtitle(expression(paste(&quot;Word Network in Jane Austen&#39;s &quot;, 
                           italic(&quot;Emma&quot;)))) +
  theme_void()

## Word clouds are a common tool too
library(wordcloud)
tb &lt;- tidy_books %&gt;%
  count(word) 
wordcloud(tb$word, tb$n, max.words = 100)

tb &lt;- tidy_books %&gt;%
  inner_join(bing) %&gt;%
  count(word, sentiment, sort = TRUE)
tb_wide &lt;- spread(tb, sentiment, n)
tb_wide[is.na(tb_wide)] &lt;- 0
tb_wide_mat &lt;- as.matrix(tb_wide[,2:3])
rownames(tb_wide_mat) &lt;- unlist(tb_wide[,1])
comparison.cloud(tb_wide_mat, colors = c(&quot;#F8766D&quot;, &quot;#00BFC4&quot;),
                max.words = 100)

#-----------------------------------------------------------------
## Beyond polarity
## Topic modeling:  
## Uses Natural Language Processing techniques to automate analysis on 
##   large collections of texts =&gt; probabilistic topic models that use
##   Latent Dirichlet Allocation (LDA)
#-----------------------------------------------------------------

## Sometimes tokenizing at the word level does not make sense:
## e.g., I am not having a good day.
## In this case, we probably want to tokenize by sentences rather than words.

austen_sentences &lt;- austen_books() %&gt;% 
  group_by(book) %&gt;% 
  unnest_tokens(sentence, text, token = &quot;sentences&quot;) %&gt;% 
  ungroup()
austen_sentences$sentence[39]


#-----------------------------------------------------------------
## In class:
## Let&#39;s play around with text from a data package, this time using
##   the &quot;nrc&quot; lexicon
#-----------------------------------------------------------------
library(gutenbergr)
gutenberg_metadata
hgwells &lt;- gutenberg_download(c(35, 36, 5230, 159))

devtools::install_github(&quot;bradleyboehmke/harrypotter&quot;)
library(harrypotter)
  



#=============================================================
## Next week: class cancelled, final take-home exam!
#=============================================================

## Potential topics for final exam:
##
## -- for/while loops, Boolean logic, Monte Carlo simulation
## -- functions
## -- error debugging based on an error/warning message
## -- effective plotting with ggplot2
## -- data wrangling with the tidyverse and dealing with messy data
## -- linear/logistic regression (coefficient interpretation, model diagnostics, etc)
## -- model selection 
## -- multiple testing correction for p-values
## -- bootstrapping and permutation tests
## -- basics of Shiny programming
## -- K-means clustering, hierarchical clustering, principal components analysis
## -- text/sentiment analysis
## -- confounding/Simpson&#39;s paradox</code></pre>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.5.1 (2018-07-02)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 17134)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gapminder_0.3.0 bindrcpp_0.2.2  forcats_0.3.0   stringr_1.3.1  
 [5] dplyr_0.7.7     purrr_0.2.5     readr_1.1.1     tidyr_0.8.2    
 [9] tibble_1.4.2    ggplot2_3.1.0   tidyverse_1.2.1

loaded via a namespace (and not attached):
 [1] tidyselect_0.2.5  haven_1.1.2       lattice_0.20-35  
 [4] colorspace_1.3-2  htmltools_0.3.6   yaml_2.2.0       
 [7] utf8_1.1.4        rlang_0.3.0.1     R.oo_1.22.0      
[10] pillar_1.3.0      glue_1.3.0        withr_2.1.2      
[13] R.utils_2.7.0     modelr_0.1.2      readxl_1.1.0     
[16] bindr_0.1.1       plyr_1.8.4        munsell_0.5.0    
[19] gtable_0.2.0      workflowr_1.1.1   cellranger_1.1.0 
[22] rvest_0.3.2       R.methodsS3_1.7.1 evaluate_0.12    
[25] knitr_1.20        fansi_0.4.0       broom_0.5.0      
[28] Rcpp_1.0.0        scales_1.0.0      backports_1.1.2  
[31] jsonlite_1.5      hms_0.4.2         digest_0.6.18    
[34] stringi_1.2.4     grid_3.5.1        rprojroot_1.3-2  
[37] cli_1.0.1         tools_3.5.1       magrittr_1.5     
[40] lazyeval_0.2.1    crayon_1.3.4      whisker_0.3-2    
[43] pkgconfig_2.0.2   xml2_1.2.0        lubridate_1.7.4  
[46] assertthat_0.2.0  rmarkdown_1.10    httr_1.3.1       
[49] rstudioapi_0.8    R6_2.3.0          nlme_3.1-137     
[52] git2r_0.23.0      compiler_3.5.1   </code></pre>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
  This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a>
  analysis was created with
  <a href="https://github.com/jdblischak/workflowr">workflowr</a> 1.1.1
</p>
<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
